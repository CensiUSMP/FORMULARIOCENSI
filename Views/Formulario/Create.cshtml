@model FORMULARIOCENSI.Models.Formulario

@{
    ViewData["Title"] = "Create";
}

<style>
    .image-upload-container {
        margin-bottom: 2rem;
    }

    .image-upload-title {
        font-size: 1.2rem;
        color: #2d3748;
        margin-bottom: 1rem;
    }

    .upload-area {
        border: 2px dashed #CBD5E0;
        border-radius: 8px;
        padding: 2rem;
        text-align: center;
        background-color: #F7FAFC;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .upload-area:hover {
        border-color: #4299E1;
        background-color: #EBF8FF;
    }

    .upload-button {
        background-color: #4299E1;
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 6px;
        border: none;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.2s;
        display: inline-block;
    }

    .upload-button:hover {
        background-color: #3182CE;
    }

    #uploadc {
        display: none;
    }

    #upload {
        display: none;
    }

    #uploada {
        display: none;
    }

    .preview-area {
        margin-top: 1rem;
        display: none;
    }

    .preview-image {
        max-width: 100%;
        max-height: 200px;
        border-radius: 4px;
        margin-top: 1rem;
    }

    .file-info {
        margin-top: 0.5rem;
        color: #4A5568;
        font-size: 0.875rem;
    }
</style>

<h1>CREAR CASO</h1>


<hr />
<div class="row">
    <div class="col-md-12">
        <form asp-action="Create" enctype="multipart/form-data" method="post">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>

            <div class="form-group">
                <label asp-for="Titulo" class="control-label"></label>
                <input asp-for="Titulo" class="form-control" />
                <span asp-validation-for="Titulo" class="text-danger"></span>
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="Sinopsis" class="control-label"></label>
                <textarea asp-for="Sinopsis" class="form-control" cols="30" rows="10"></textarea>
                <span asp-validation-for="Sinopsis" class="text-danger"></span>
            </div>

            <h3>Estados</h3>
            <div id="estadosContainer" style="margin-bottom: 20px;">
                <div class="form-group">
                    <div class="col-md-1">
                        <label for="Estados_0_Nombre">Número</label>
                        <input type="text" name="Estados[0].Numero" class="form-control" placeholder="Ingrese N°" />
                    </div>

                    <label for="Estados_0_Nombre">Nombre</label>
                    <input type="text" name="Estados[0].Nombre" class="form-control"
                        placeholder="Ingrese el nombre del estado" />

                    <label for="Estados_0_Descripcion">Descripción del Estado</label>
                    <textarea type="text" name="Estados[0].Descripcion" class="form-control"
                        placeholder="Ingrese la descripción del estado" cols="15" rows="10" /></textarea>
                </div>
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <button type="button" class="btn btn-secondary" id="addEstadoButton">Agregar Estado<i
                        class="fa-solid fa-plus" style="margin-left: 5px;"></i></button>
            </div>
            <h3>Flujograma</h3>
            <div class="upload-area" id="dropZoneFlujograma">
                <p>Arrastra y suelta tu flujograma aquí o</p>
                <label class="upload-button" for="upload">
                    Seleccionar archivo
                </label>
                <input type="file" id="upload" name="upload" accept="image/*" />
            </div>
            <div class="preview-area" id="previewAreaFlujograma">
                <img class="preview-image" id="previewImageFlujograma" alt="Vista previa" />
                <div class="file-info" id="fileInfoFlujograma"></div>
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="Autores" class="control-label"></label>
                <textarea asp-for="Autores" class="form-control" cols="30" rows="10"></textarea>
                <span asp-validation-for="Autores" class="text-danger"></span>
            </div>
            <h4>Antecedentes del paciente</h4>
            <h3>Historia clínica del paciente</h3>
            <div class="form-group">
                <label asp-for="Historial_medico" class="control-label"></label>
                <textarea asp-for="Historial_medico" class="form-control" cols="30" rows="5"></textarea>
                <span asp-validation-for="Historial_medico" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Alergias" class="control-label"></label>
                <textarea asp-for="Alergias" class="form-control"></textarea>
                <span asp-validation-for="Alergias" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Medicamentos" class="control-label"></label>
                <textarea asp-for="Medicamentos" class="form-control"></textarea>
                <span asp-validation-for="Medicamentos" class="text-danger"></span>
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="Historia_familiar" class="control-label"></label>
                <textarea asp-for="Historia_familiar" class="form-control"></textarea>
                <span asp-validation-for="Historia_familiar" class="text-danger"></span>
            </div>
            <h3>Nota del ingreso</h3>
            <div class="form-group">
                <label asp-for="Situacion" class="control-label"></label>
                <textarea asp-for="Situacion" class="form-control" cols="30" rows="5"></textarea>
                <span asp-validation-for="Situacion" class="text-danger"></span>
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="Nota_de_hospitalizacion" class="control-label"></label>
                <textarea asp-for="Nota_de_hospitalizacion" class="form-control" cols="30" rows="5"></textarea>
                <span asp-validation-for="Nota_de_hospitalizacion" class="text-danger"></span>
            </div>
            <h3>Exámen físico</h3>
            <div class="form-group">
                <label asp-for="Signos_vitales" class="control-label"></label>
                <textarea asp-for="Signos_vitales" class="form-control"></textarea>
                <span asp-validation-for="Signos_vitales" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Estado_general" class="control-label"></label>
                <textarea asp-for="Estado_general" class="form-control"></textarea>
                <span asp-validation-for="Estado_general" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Piel" class="control-label"></label>
                <textarea asp-for="Piel" class="form-control"></textarea>
                <span asp-validation-for="Piel" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Torax" class="control-label"></label>
                <textarea asp-for="Torax" class="form-control"></textarea>
                <span asp-validation-for="Torax" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="CV" class="control-label"></label>
                <textarea asp-for="CV" class="form-control"></textarea>
                <span asp-validation-for="CV" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Abdomen" class="control-label"></label>
                <textarea asp-for="Abdomen" class="form-control"></textarea>
                <span asp-validation-for="Abdomen" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Neurologico" class="control-label"></label>
                <textarea asp-for="Neurologico" class="form-control"></textarea>
                <span asp-validation-for="Neurologico" class="text-danger"></span>
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="Laboratorio" class="control-label"></label>
                <textarea asp-for="Laboratorio" class="form-control"></textarea>
                <span asp-validation-for="Laboratorio" class="text-danger"></span>
            </div>

            <h3>Imágenes</h3>
            <div class="upload-area" id="dropZoneImagesa">
                <p>Arrastra y suelta tu imagen aquí o</p>
                <label class="upload-button" for="uploada">
                    Seleccionar archivo
                </label>
                <input type="file" id="uploada" name="uploada" accept="image/*" />
            </div>
            <div class="preview-area" id="previewAreaImagesa">
                <img class="preview-image" id="previewImageImagesa" alt="Vista previa" />
                <div class="file-info" id="fileInfoImagesa"></div>
            </div>
            <h3>Órdenes</h3>
            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="Orden_inicial" class="control-label"></label>
                <textarea asp-for="Orden_inicial" class="form-control" cols="30" rows="30"></textarea>
                <span asp-validation-for="Orden_inicial" class="text-danger"></span>
            </div>
            <h3>Preparación</h3>
            <h3>Objetivos del aprendizaje</h3>
            <div class="form-group">
                <label asp-for="Distinguir" class="control-label"></label>
                <textarea asp-for="Distinguir" class="form-control"></textarea>
                <span asp-validation-for="Distinguir" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Indicar" class="control-label"></label>
                <textarea asp-for="Indicar" class="form-control"></textarea>
                <span asp-validation-for="Indicar" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Analizar" class="control-label"></label>
                <textarea asp-for="Analizar" class="form-control"></textarea>
                <span asp-validation-for="Analizar" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Evaluación" class="control-label"></label>
                <textarea asp-for="Evaluación" class="form-control"></textarea>
                <span asp-validation-for="Evaluación" class="text-danger"></span>
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="Aplicar" class="control-label"></label>
                <textarea asp-for="Aplicar" class="form-control"></textarea>
                <span asp-validation-for="Aplicar" class="text-danger"></span>
            </div>
            <h3>Desempeño como medida del aprendizaje</h3>
            <h3>Medidas esenciales de rendimiento del escenario</h3>
            <div class="form-group">
                <label asp-for="Medidas_esenciales" class="control-label"></label>
                <textarea asp-for="Medidas_esenciales" class="form-control" cols="30" rows="10"></textarea>
                <span asp-validation-for="Medidas_esenciales" class="text-danger"></span>
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="Baseline" class="control-label"></label>
                <textarea asp-for="Baseline" class="form-control" cols="30" rows="5"></textarea>
                <span asp-validation-for="Baseline" class="text-danger"></span>
            </div>

            <h3>Estados</h3>
            <div id="estadosaContainer" style="margin-bottom: 20px;">
                <div class="form-group">
                    <div class="col-md-1">
                        <label for="Estadosa_0_Nombre">Número</label>
                        <input type="text" name="Estadosa[0].Numero" class="form-control" placeholder="Ingrese N°" />
                    </div>

                    <label for="Estadosa_0_Nombre">Nombre</label>
                    <input type="text" name="Estadosa[0].Nombre" class="form-control"
                        placeholder="Ingrese el nombre del estado" />

                    <label for="Estadosa_0_Descripcion">Descripción del Estado</label>
                    <textarea type="text" name="Estadosa[0].Descripcion" class="form-control"
                        placeholder="Ingrese la descripción del estado" cols="30" rows="10" /></textarea>
                </div>
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <button type="button" class="btn btn-secondary" id="addEstadoaButton">Agregar estado<i
                        class="fa-solid fa-plus" style="margin-left: 5px;"></i></button>
            </div>

            <div class="form-group">
                <label asp-for="Preguntas_de_preparacion" class="control-label"></label>
                <textarea asp-for="Preguntas_de_preparacion" class="form-control" cols="30" rows="10"></textarea>
                <span asp-validation-for="Preguntas_de_preparacion" class="text-danger"></span>
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="Equipos_de_suministro" class="control-label"></label>
                <textarea asp-for="Equipos_de_suministro" class="form-control" cols="30" rows="10"></textarea>
                <span asp-validation-for="Equipos_de_suministro" class="text-danger"></span>
            </div>

            <h3>Diálogo</h3>
            <div id="dialogoContainer" style="margin-bottom: 20px;">
                <div class="form-group">
                    <div class="col-md-3">
                        <label for="Dialogo_0_Personaje">Personaje</label>
                        <input type="text" name="Dialogo[0].Personaje" class="form-control"
                            placeholder="Ingrese el nombre del personaje" />
                    </div>

                    <label for="Dialogo_0_Guion">Guión</label>
                    <textarea type="text" name="Dialogo[0].Guion" class="form-control"
                        placeholder="Ingrese el guión del personaje" cols="30" rows="5" /></textarea>

                </div>
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <button type="button" class="btn btn-secondary" id="addDialogoButton">Agregar Dialogo<i
                        class="fa-solid fa-plus" style="margin-left: 5px;"></i></button>
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="Confederado" class="control-label"></label>
                <textarea asp-for="Confederado" class="form-control" cols="30" rows="5"></textarea>
                <span asp-validation-for="Confederado" class="text-danger"></span>
            </div>

            <h3>Archivos Adicionales</h3>
            <div>
                <label type="button" id="custom-button-archivo">Cargar Archivo Adicional</label>
                <input type="file" id="uploadArchivo" name="uploadArchivo" />


            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label>Texto extraído del PDF:</label>
                <textarea asp-for="ArchivoTextoExtraido" class="form-control" readonly></textarea>
            </div>

            <div class="form-group">
                <label asp-for="Introduccion" class="control-label"></label>
                <textarea asp-for="Introduccion" class="form-control"></textarea>
                <span asp-validation-for="Introduccion" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="Emociones" class="control-label"></label>
                <textarea asp-for="Emociones" class="form-control"></textarea>
                <span asp-validation-for="Emociones" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="Descripcion" class="control-label"></label>
                <textarea asp-for="Descripcion" class="form-control"></textarea>
                <span asp-validation-for="Descripcion" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="Analisis" class="control-label"></label>
                <textarea asp-for="Analisis" class="form-control"></textarea>
                <span asp-validation-for="Analisis" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="Sintesis" class="control-label"></label>
                <textarea asp-for="Sintesis" class="form-control"></textarea>
                <span asp-validation-for="Sintesis" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="PreguntasDD" class="control-label"></label>
                <textarea asp-for="PreguntasDD" class="form-control" cols="30" rows="30"></textarea>
                <span asp-validation-for="PreguntasDD" class="text-danger"></span>
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="BaselineApren" class="control-label"></label>
                <textarea asp-for="BaselineApren" class="form-control"></textarea>
                <span asp-validation-for="BaselineApren" class="text-danger"></span>
            </div>

            <h3>Estados</h3>
            <div id="statusContainer" style="margin-bottom: 20px;">
                <div class="form-group">
                    <div class="col-md-1">
                        <label for="Status_0_Nombre">Número</label>
                        <input type="text" name="Status[0].Numero" class="form-control" placeholder="Ingrese N°" />
                    </div>

                    <label for="Status_0_Nombre">Nombre</label>
                    <input type="text" name="Status[0].Nombre" class="form-control"
                        placeholder="Ingrese el nombre del estado" />

                    <label for="Status_0_Descripcion">Descripción del Estado</label>
                    <textarea type="text" name="Status[0].Descripcion" class="form-control"
                        placeholder="Ingrese la descripción del estado" cols="30" rows="10" /></textarea>
                </div>
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <button type="button" class="btn btn-secondary" id="addStatusButton">Agregar Estado<i
                        class="fa-solid fa-plus" style="margin-left: 5px;"></i></button>
            </div>

            <div class="form-group">
                <label asp-for="ReferenciasB" class="control-label"></label>
                <textarea asp-for="ReferenciasB" class="form-control" cols="30" rows="10"></textarea>
                <span asp-validation-for="ReferenciasB" class="text-danger"></span>
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <label asp-for="EscenariosP" class="control-label"></label>
                <textarea asp-for="EscenariosP" class="form-control" cols="30" rows="5"></textarea>
                <span asp-validation-for="EscenariosP" class="text-danger"></span>
            </div>

            <h3>Imágenes</h3>
            <div class="upload-area" id="dropZoneImages">
                <p>Arrastra y suelta tu imagen aquí o</p>
                <label class="upload-button" for="uploadc">
                    Seleccionar archivo
                </label>
                <input type="file" id="uploadc" name="uploadc" accept="image/*" />
            </div>
            <div class="preview-area" id="previewAreaImages">
                <img class="preview-image" id="previewImageImages" alt="Vista previa" />
                <div class="file-info" id="fileInfoImages"></div>
            </div>

            <hr>
            <div class="text-right d-flex justify-content-end">
                <input type="submit" value="Crear" class="btn btn-success mx-1" />
                <a class="btn btn-primary mx-1" asp-action="Index2">Regresar a la lista</a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        let estadoCount = 1;

        document.getElementById("addEstadoButton").onclick = function () {
            let newEstadoInput = document.createElement("div");
            newEstadoInput.classList.add("form-group");
            newEstadoInput.innerHTML = `
                            <div class="col-md-1">
                                                    <label for="Estados_${estadoCount}_Numero">Estado</label>
                                                    <input type="number" name="Estados[${estadoCount}].Numero" class="form-control" placeholder="Ingrese N°" value="${estadoCount + 1}"/>
                                                    </div>

                                                    <label for="Estados_${estadoCount}_Nombre">Nombre del Estado</label>
                                                    <input type="text" name="Estados[${estadoCount}].Nombre" class="form-control" placeholder="Ingrese el nombre del estado" />

                                                    <label for="Estados_${estadoCount}_Descripcion">Descripción del Estado</label>
                                                    <textarea type="text" name="Estados[${estadoCount}].Descripcion" class="form-control" placeholder="Ingrese la descripción del estado" cols="30" rows="10" /></textarea>
                                                `;
            document.getElementById("estadosContainer").appendChild(newEstadoInput);
            estadoCount++;
        };

        let estadoaCount = 1;

        document.getElementById("addEstadoaButton").onclick = function () {
            let newEstadoaInput = document.createElement("div");
            newEstadoaInput.classList.add("form-group");
            newEstadoaInput.innerHTML = `
                            <div class="col-md-1">
                                                    <label for="Estadosa_${estadoaCount}_Numero">Estado</label>
                                                    <input type="number" name="Estadosa[${estadoaCount}].Numero" class="form-control" placeholder="Ingrese N°" value="${estadoaCount + 1}" />
                                                    </div>

                                                    <label for="Estadosa_${estadoaCount}_Nombre">Nombre del Estado</label>
                                                    <input type="text" name="Estadosa[${estadoaCount}].Nombre" class="form-control" placeholder="Ingrese el nombre del estado" />

                                                    <label for="Estadosa_${estadoaCount}_Descripcion">Descripción del Estado</label>
                                                    <textarea type="text" name="Estadosa[${estadoaCount}].Descripcion" class="form-control" placeholder="Ingrese la descripción del estado" cols="30" rows="10" /></textarea>
                                                `;
            document.getElementById("estadosaContainer").appendChild(newEstadoaInput);
            estadoaCount++;
        };

        let dialogoCount = 1;

        document.getElementById("addDialogoButton").onclick = function () {
            let newDialogoInput = document.createElement("div");
            newDialogoInput.classList.add("form-group");
            newDialogoInput.innerHTML = `
                            <div class="col-md-3">
                                                    <label for="Dialogo_${dialogoCount}_Personaje">Personaje</label>
                                                    <input type="text" name="Dialogo[${dialogoCount}].Personaje" class="form-control" placeholder="Ingrese el nombre del personaje" />
                                                    </div>

                                                    <label for="Dialogo_${dialogoCount}_Guion">Guion</label>
                                                    <textarea type="text" name="Dialogo[${dialogoCount}].Guion" class="form-control" placeholder="Ingrese el guión del personaje" cols="30" rows="5" /></textarea>

                                                `;
            document.getElementById("dialogoContainer").appendChild(newDialogoInput);
            dialogoCount++;
        };

        document.addEventListener("DOMContentLoaded", function () {
            let archivoCount = 1;

            let addArchivoButton = document.getElementById("custom-button-archivo");
            if (addArchivoButton) {  // Verifica que el botón existe
                addArchivoButton.onclick = function () {
                    let newArchivoInput = document.createElement("div");
                    newArchivoInput.classList.add("form-group");
                    newArchivoInput.innerHTML = `
                                        <label for="ArchivosAdicionales_${archivoCount}_Nombre">Nombre del Archivo</label>
                                        <input type="text" name="ArchivosAdicionales[${archivoCount}].Nombre" class="form-control" placeholder="Ingrese un nombre para el archivo" required />

                                        <label for="ArchivosAdicionales_${archivoCount}_Archivo">Archivo</label>
                                        <input type="file" name="ArchivosAdicionales[${archivoCount}].Archivo" class="form-control-file" accept="*/*" required />
                                    `;
                    document.getElementById("archivosContainer").appendChild(newArchivoInput);
                    archivoCount++;
                };
            } else {
                console.log("El botón con ID 'custom-button-archivo' no se encuentra en el DOM.");
            }
        });

        document.addEventListener("DOMContentLoaded", function () {
            let statuCount = 1;

            document.getElementById("addStatusButton").addEventListener("click", function () {
                console.log("Botón clickeado");
                let newStatusInput = document.createElement("div");
                newStatusInput.classList.add("form-group");
                newStatusInput.innerHTML = `
                                <div class="col-md-1">
                                        <label for="Status_${statuCount}_Numero">Estado</label>
                                        <input type="number" name="Status[${statuCount}].Numero" class="form-control" placeholder="Ingrese N°" value="${statuCount + 1}" />
                                        </div>

                                        <label for="Status_${statuCount}_Nombre">Nombre del estado</label>
                                        <input type="text" name="Status[${statuCount}].Nombre" class="form-control" placeholder="Ingrese el nombre del estado" />

                                        <label for="Status_${statuCount}_Descripcion">Descripción del estado</label>
                                        <textarea type="text" name="Status[${statuCount}].Descripcion" class="form-control" placeholder="Ingrese la descripción del estado" cols="30" rows="10" /></textarea>
                                    `;
                document.getElementById("statusContainer").appendChild(newStatusInput);
                statuCount++;
            });
        });
        document.addEventListener('DOMContentLoaded', function () {
            const dropZone = document.getElementById('dropZoneImages');
            const fileInput = document.getElementById('uploadc');
            const previewArea = document.getElementById('previewAreaImages');
            const previewImage = document.getElementById('previewImageImages');
            const fileInfo = document.getElementById('fileInfoImages');

            // Prevenir comportamientos por defecto
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            // Manejar archivos
            fileInput.addEventListener('change', handleFileSelect);
            dropZone.addEventListener('drop', handleDrop);

            function handleFileSelect(e) {
                const file = this.files[0];
                if (file) displayFile(file);
            }

            function handleDrop(e) {
                const file = e.dataTransfer.files[0];
                if (file) {
                    fileInput.files = e.dataTransfer.files;
                    displayFile(file);
                }
            }

            function displayFile(file) {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();

                    reader.onload = function (e) {
                        previewImage.src = e.target.result;
                        previewArea.style.display = 'block';
                        fileInfo.textContent = `${file.name} (${formatFileSize(file.size)})`;
                    }

                    reader.readAsDataURL(file);
                } else {
                    alert('Por favor, selecciona solo archivos de imagen.');
                    fileInput.value = '';
                }
            }

            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            const dropZone = document.getElementById('dropZoneFlujograma');
            const fileInput = document.getElementById('upload');
            const previewArea = document.getElementById('previewAreaFlujograma');
            const previewImage = document.getElementById('previewImageFlujograma');
            const fileInfo = document.getElementById('fileInfoFlujograma');

            // Prevenir comportamientos por defecto
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            // Manejar archivos
            fileInput.addEventListener('change', handleFileSelect);
            dropZone.addEventListener('drop', handleDrop);

            function handleFileSelect(e) {
                const file = this.files[0];
                if (file) displayFile(file);
            }

            function handleDrop(e) {
                const file = e.dataTransfer.files[0];
                if (file) {
                    fileInput.files = e.dataTransfer.files;
                    displayFile(file);
                }
            }

            function displayFile(file) {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();

                    reader.onload = function (e) {
                        previewImage.src = e.target.result;
                        previewArea.style.display = 'block';
                        fileInfo.textContent = `${file.name} (${formatFileSize(file.size)})`;
                    }

                    reader.readAsDataURL(file);
                } else {
                    alert('Por favor, selecciona solo archivos de imagen.');
                    fileInput.value = '';
                }
            }

            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            const dropZone = document.getElementById('dropZoneImagesa');
            const fileInput = document.getElementById('uploada');
            const previewArea = document.getElementById('previewAreaImagesa');
            const previewImage = document.getElementById('previewImageImagesa');
            const fileInfo = document.getElementById('fileInfoImagesa');

            // Prevenir comportamientos por defecto
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            // Manejar archivos
            fileInput.addEventListener('change', handleFileSelect);
            dropZone.addEventListener('drop', handleDrop);

            function handleFileSelect(e) {
                const file = this.files[0];
                if (file) displayFile(file);
            }

            function handleDrop(e) {
                const file = e.dataTransfer.files[0];
                if (file) {
                    fileInput.files = e.dataTransfer.files;
                    displayFile(file);
                }
            }

            function displayFile(file) {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();

                    reader.onload = function (e) {
                        previewImage.src = e.target.result;
                        previewArea.style.display = 'block';
                        fileInfo.textContent = `${file.name} (${formatFileSize(file.size)})`;
                    }

                    reader.readAsDataURL(file);
                } else {
                    alert('Por favor, selecciona solo archivos de imagen.');
                    fileInput.value = '';
                }
            }

            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
        });
    </script>
}